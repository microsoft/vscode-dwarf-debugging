# This file is based on a file from revision cf3a5c70b97b388fff3490b62f1bdaaa6a26f8e1 
# of the Chrome DevTools C/C++ Debugging Extension, see the wasm/symbols-backend/LICENSE file.
#
# https://github.com/ChromeDevTools/devtools-frontend/blob/main/extensions/cxx_debugging/e2e/tests/scope_view_non_primitives_cpp.yaml

name: Scope view formats non primitive types correctly for cpp
# This test checks that the scope view displays
# arrays, structs, references, pointers and
# classes correctly for C++
source_file: resources/scope-view-non-primitives.cpp
flags: [
  [-g, -fdebug-compilation-dir=., -fno-limit-debug-info, -sWASM_BIGINT, -sERROR_ON_WASM_CHANGES_AFTER_LINK],
  [-g, -fdebug-compilation-dir=., -fno-limit-debug-info, -sWASM_BIGINT, -sERROR_ON_WASM_CHANGES_AFTER_LINK, -gsplit-dwarf],
  [-g, -fdebug-compilation-dir=., -gdwarf-5, -sWASM_BIGINT, -sERROR_ON_WASM_CHANGES_AFTER_LINK],
  [-g, -fdebug-compilation-dir=., -gdwarf-5, -sWASM_BIGINT, -sERROR_ON_WASM_CHANGES_AFTER_LINK, -gsplit-dwarf, -gpubnames]]
script:
  - reason: setup
    actions:
    - file: scope-view-non-primitives.cpp
      action: set_breakpoint
      breakpoint: 43
  - reason: breakpoint
    file: scope-view-non-primitives.cpp
    line: 43
    variables:
      - name: Local.a
        value: int[5]
      - name: Local.p
        value: int *
      - name: Local.p.$0
        value: 10
      - name: Local.r
        value: 10
      - name: Local.dob
        value: Birthday
      - name: Local.dob.year
        value: 1912
      - name: Local.rec
        value: Rectangle
      - name: Local.rec.height
        value: 6
      - name: Local.s
        value: kScopedB
      - name: Local.u
        value: kUnscopedB
